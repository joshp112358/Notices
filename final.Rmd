---
title: "Citations Analysis of Letter Signers"
author: "Joshua Paik and Igor Rivin"
output:
  html_document:
    number_sections: true
    toc: yes
  pdf_document:
    keep_tex: yes
    toc: yes
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Abstract
An opinion piece by Abigail Thompson in the AMS Notices has engendered a lot of discussion, including not one, not two, but three open letters to the Notices. We analyze the professional profiles of the signers of the three letters, and propose a theory for why the results are what they are.

# Introduction

In November 2019, Abigail Thompson, chair of Mathematics at UC Davis and Vice President of the American Mathematical Society, published an essay  [[1](#Bibliography)] in the Notices of the AMS that criticized the usage of Mandatory Diversity Statements when hiring mathematics faculty. She described Diversity Statements as a "political test" and compared it to McCarthyism.

In December 2019, a multitude of responses to Thompson's Letter were published in Notices [[2](#Bibliography)], accumulating hundreds of signatures. One letter, titled "The math community values a commitment to diversity," "strongly (disagreed) with the sentiments and arguments in Dr. Thompson’s editorial," and hoped "that the AMS
will reconsider the way that it uses its power and position
in the mathematics communities in these kinds of discussions." Another letter, titled "Letter to the Editor," spoke of "grave concerns about recent attempts to intimidate a voice within our mathematical community." In this letter, they reference a blog post which encouraged faculty to "advise grad-school-bound undergraduate students – especially students who are minoritized along some axis – not to apply to UC Davis." [[3](#Bibliography)] A final letter, titled "Letter to the Notices of the AMS," criticized the usage of mandatory diversity statements, but affirmed the importance of diversity in mathematics. 

For the purpose of this exploration, Letter A will refer to the letter titled "The math community values a commitment to diversity," Letter B will refer to the one titled "Letter to the Editor," and Letter C will refer to the one titled "Letter to the Notices of the AMS." 

We will analyze the age (relative to PhD year) and gender of letter signers. We will also analyze the number of MathSciNet citations and citations per year of letter signers in this study. We will also analyze the number of Google Scholar citations, citation per year and h-index of letter signers. We prefer MathSciNet because only published mathematics are in MathSciNet, and is hence a higher quality data source when comparing mathematicians. We also assess the distributions of MathSciNet and Google Scholar citations. 


It should be noted and emphasized that citations and h-indices do not impose a total order on the quality of a mathematician - indeed, it is quite obvious that, unlike in competitive swimming, imposing such an order is a fool's errand. For example, Stephen Smale has fewer citations than Terence Tao, but it would very difficult to distinguish who is in fact the better mathematician. However, citations generally reflect the mathematics communities opinion of a person, and is the only empirical metric of assessing this.

Most of the rest of this paper gives the methodology of our statistical analyses, and the impatient reader can skip straight to the Conclusions and Discussion -  Section 6.



# Data Collection
```{r, include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(MASS)
df <- read_csv("~/Desktop/Notices/withAMS.csv")
```

Data was collected on December 16-18, 2019 from Google Scholar and the Mathematics Genealogy Project. After a list of names and affiliations were scraped from the AMS response letters, signers were searched on Google Scholar and their citation numbers and h-index were collected. This was done using the scholarly API and manual checks.[[4](#Bibliography)] [[5](#Bibliography)] Then the math-genealogy-scraper was used to calculate PhD years and errors (duplicate names) were also corrected manually. [[6](#Bibliography)] [[7](#Bibliography)].  MathSciNet entries were collected manually. Finally, the data was merged with the QSIDE dataset released on December 28th [[8](#Bibliography)]. 

# Summary Statistics

```{r, echo=FALSE}
df$age <- (2020- df$year)
df$citperyear <- df$citations/df$age
df$amscitperyear <- df$amscit/df$age
df$lettergroup <- as.factor(df$lettergroup)
df$gender <- as.factor(df$gender)
df$role <- as.factor(df$role)
df$highered <- as.factor(df$highered)
df$institution <- as.factor(df$institution)
df$research <- as.factor(df$research)
df$country <- as.factor(df$country)
df$security <- as.factor(df$security)
df$field <- as.factor(df$field)
df$simplefield <- as.factor(df$simplefield)
summary(df)
```

# Exploratory Data Analysis

## NaN Visualization

```{r, echo=FALSE}
library(naniar)
vis_miss(df)
```

The citations and h-index column refers to citations and h-indices pulled from Google Scholar. The amscit column refers to citations pulled from Math Sci Net. The year column refers to PhD years scraped from the Mathematics Genealogy Project. The age column was induced by subtracting 2020 from PhD years. The citperyear and amscitper year columns were induced by dividing citations by age. The fellows column refer to individuals who are fellows of the AMS. 

64.11% of the Google Scholar citations is NaN, and 75.47% of the mathscinet citations is NaN. While this is not optimal, a quick sample size calculation shows that one needs 303 samples or 21% of the data to produce statistics at a 95% confidence level and a 5% confidence interval. 

## Distribution of Google Scholar Citations
```{r, echo = FALSE}
hist(df$citations,
     main = "Histogram of Google Scholar Citations",
     xlab = "Number of Citations")
```

The data is heavily left skewed. This is usually handled either by transforming the data with a natural logarithm, or by square rooting. Applying a logarithm is a more appropiate transformation to assess normality, and a square root is more appropriate to assess exponentiality. We try both.

```{r, echo=FALSE}
hist(log(df$citations),
     main = "Histogram of log(citations)",
     xlab = "Number of Citations")
```

This data is now right skewed. 

```{r, echo=FALSE}
qplot(sample = na.omit(log(df$citations)), geom = 'blank') +
  stat_qq()+
  stat_qq_line()+
  ggtitle("Normal QQplot for GS Citations")
```

The data is heavy towards the center, and the tails are sparsely populated. Hence the data is unlikely to be normally distributed. 

If we construct a qq-plot with a fitted exponential curve, we find that there is divergence in the tails. 

```{r, echo=FALSE}
Z <- na.omit(df$citations)

params <- as.list(fitdistr(Z, "exponential")$estimate)

library(ggplot2)
qplot(sample = Z, geom = 'blank') +
  stat_qq(distribution = qexp, dparams = params)+
  stat_qq_line(distribution = qexp, dparams = params)+
  ggtitle("Exponential QQ-plot with citations")
```

We now apply a square root. 

```{r, echo=FALSE}
hist(df$citations^0.5,
     main = "Histogram of GS sqrt(citations)",
     xlab = "Number of Citations")
```

This looks like an exponential distribution.

```{r, echo=FALSE}
Z <- na.omit(df$citations^0.5)
params <- as.list(fitdistr(Z, "exponential")$estimate)

qplot(sample = Z, geom = 'blank') +
  stat_qq(distribution = qexp, dparams = params)+
  stat_qq_line(distribution = qexp, dparams = params)+
  ggtitle("Exponential QQ-plot with GS citations^0.5")
```

An exponential distribution seems to fit the data better, post square rooting. Some fine tuning shows that raising the data to 0.46 produces the closest approximation to an exponential distribution. 

```{r, echo=FALSE}
Z <- na.omit(df$citations^0.46)
params <- as.list(fitdistr(Z, "exponential")$estimate)

qplot(sample = Z, geom = 'blank') +
  stat_qq(distribution = qexp, dparams = params)+
  stat_qq_line(distribution = qexp, dparams = params)+
  ggtitle("Exponential QQ-plot with citations^0.46")
```

## Distribution of MathSciNet citations
```{r, echo = FALSE}
hist(df$amscit,
     main = "Histogram of MathSciNet Citations",
     xlab = "Number of Citations")
```

The data is again left skewed. Fitting an exponential distribution to this data, we see that there is divergence in the tails.

```{r, echo=FALSE}
Z <- na.omit(df$amscit)

params <- as.list(fitdistr(Z, "exponential")$estimate)

library(ggplot2)
qplot(sample = Z, geom = 'blank') +
  stat_qq(distribution = qexp, dparams = params)+
  stat_qq_line(distribution = qexp, dparams = params)+
  ggtitle("Exponential QQ-plot with MathSciNet Citations")
```

We now apply a square root. 

```{r, echo=FALSE}
hist(df$amscit^0.5,
     main = "Histogram of MathSciNet sqrt(citations)",
     xlab = "Number of Citations")
```

The data again looks approximately exponentially distributed, except for the data on the right. This is due to the presence of academics with zero citations. 

```{r, echo=FALSE}
Z <- na.omit(df$amscit^0.5)
params <- as.list(fitdistr(Z, "exponential")$estimate)

qplot(sample = Z, geom = 'blank') +
  stat_qq(distribution = qexp, dparams = params)+
  stat_qq_line(distribution = qexp, dparams = params)+
  ggtitle("Exponential QQ-plot with MathSciNet citations^0.5")
```

The divergence in the left tail is caused by a number of mathematicians with zero citations. Some fine tuning shows that raising the data to 0.54 produces the closest approximation to an exponential distribution. 

```{r, echo=FALSE}
Z <- na.omit(df$amscit^0.54)
params <- as.list(fitdistr(Z, "exponential")$estimate)

qplot(sample = Z, geom = 'blank') +
  stat_qq(distribution = qexp, dparams = params)+
  stat_qq_line(distribution = qexp, dparams = params)+
  ggtitle("Exponential QQ-plot with MathSciNet citations^0.54")
```

If we check if the data is Normally distributed, we see again that there is sparsity in the tails. Hence it is unlikely that the data is log normal. 
```{r, echo=FALSE}
hist(log(df$amscit),
     main = "Histogram of log(Math Sci Net citations)",
     xlab = "Number of Citations")
```


```{r, echo=FALSE}
qplot(sample = na.omit(log(df$citations)), geom = 'blank') +
  stat_qq()+
  stat_qq_line()+
  ggtitle("Normal QQplot for Math Sci Net Citations")
```

So the MathSciNet data and GS data, when appropriately transformed, appear to be approximately Exponentially distributed. 

## Permutation Tests

A permutation test is a nonparametric way of assessing the difference in mean between two populations. We are interested in whether an observed difference in mean is due to chance, and we can assess this in the following way.


0. Record the true difference in mean ($d\mu$).
1. $H_0: d\mu = 0, H_1: d\mu < 0$
2. Sample without replacement 1/2 of the combined data set (X) and what is left (Y)
3. Take the mean of X and Y and record the difference
4. Repeat 10,000 times and plot the histogram
5. Record the number of points (m) in the induced distribution that is more extreme than or equal to the observed $d\mu$. The probability m/10,000 is the probability that what was observed was due to chance. 


Here is the function we will use to do this.

```{r}
# input data and the number of permutations
meanPermutation <- function(Data, n){
  output <- matrix(NA, ncol = 1, nrow = n)
  for(i in 1:n){
    #sample 1/2 of the data
    X_index <- sample(1:length(Data), floor(0.5 * length(Data)))
    Y_index <- setdiff(1:length(Data), X_index)
    X <- Data[X_index]
    Y <- Data[Y_index]
    #calculate the difference
    diff <- mean(X)-mean(Y)
    #store
    output[i, ] <- diff
  } 
  return(output)
}
```

The induced probability is similar to p-value, and often produces a similar p-value to a 2-sample t-test. However, it is not a p-value and cannot be accurately interpreted using the standard 0.05 significance benchmark. Instead, probabilities are assessed relatively. 

## Gender

What is the proportion of female professors who signed letters A, B, and C. According to a 2016 AMS survey [[9](#Bibliography)], 707/4902 = 14.4% of tenured professors are women, and including all professionals, 2004/9921 = 20.2% are women. 

We can determine this by using dplyr's filter function. 

```{r}
#search via booleans
table(filter(df,((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$gender)
```
On letter A, 68/147 = 46.3% of professors were women. 
```{r}
table(filter(df,((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$gender)
```
On letter B, 40/312 = 12.8% of professors were women. 
```{r}
table(filter(df,((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$gender)
```
On letter C, 37/182 = 20.3% of professors were women. 

So while letter A was signed by proportionally more female professors than the proportion determined by the AMS, letters B and C were generally reflective of the field, with C over representing the number of tenured female professors, and B slightly under representing the number of tenured female professors. 

## Age

What is the mean age of signers relative to PhD graduation? Are signers of B and C older than signers of A?

```{r, echo = FALSE, warning = FALSE}
plot1 <- ggplot(df, aes(x=age))+
  geom_histogram(data=filter(df, (lettergroup == "A Only"|lettergroup == "A and B")),fill = "red", alpha = 0.2, binwidth = 5) + 
  geom_histogram(data=filter(df, (lettergroup == "B Only"|lettergroup == "A and B")),fill = "blue", alpha = 0.2, binwidth = 5) +
  geom_histogram(data=filter(df, (lettergroup == "C Only"|lettergroup == "C and B")),fill = "green", alpha = 0.2, binwidth = 5) +
  # Place dotted lines for mean values
  geom_vline(xintercept = mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$age, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$age, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$age, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Age Comparison (A=red), (B=blue), (C=green)")
plot1
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$age, na.rm = TRUE)
mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$age, na.rm = TRUE)
mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$age, na.rm = TRUE)
median(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$age, na.rm = TRUE)
median(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$age, na.rm = TRUE)
median(filter(df, (lettergroup == "C Only"|lettergroup == "C and B"))$age, na.rm = TRUE)
```

The mean time since PhD completion of signers of Letter A is 14.6435 years and the median time is 13 years. The mean time since PhD completion of signers of Letter B is 26.35433 years and the median time is 24 years. The mean time since PhD completion of signers of Letter C is 35.48 years and the median time is 37 years.

So signers of Letter C seem to be older than signers of Letter B, who in turn seem older than signers of letter A. Let's validate this using a permutation test. 

```{r}
muA <- mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$age, na.rm = TRUE)
muB <- mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$age, na.rm = TRUE)
muC <- mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$age, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC
set.seed(0)
dist <- meanPermutation(na.omit(df$age,cols="age"),10000)

hist(dist,
     main = "Age",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")

```

All three differences in mean age lie outside of the induced distribution, so it is unlikely that the observed differences were due to chance, and we can reject all three null hypotheses. 

## Citations

How do the number of citations compare amongst signers of letter A, B, and C? This is a trickier question, because many things influence how many citations a researcher has - age and field for instance - and the number of citations differ between Google Scholar, which includes preprints, and MathSciNet, which only includes published papers. We will subset accordingly, and run permutation tests on each to validate.

### Math Sci Net citations 

```{r, echo = FALSE, warning=FALSE}
plot3 <- ggplot(df, aes(x=amscit))+
  geom_histogram(data=filter(df, (lettergroup == "A Only"|lettergroup == "A and B")),fill = "red", alpha = 0.2, binwidth = 300) + 
  geom_histogram(data=filter(df, (lettergroup == "B Only"|lettergroup == "A and B")),fill = "blue", alpha = 0.2, binwidth = 300) +
  geom_histogram(data=filter(df, (lettergroup == "C Only"|lettergroup == "C and B")),fill = "green", alpha = 0.2, binwidth = 300) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscit, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("MathSciNet Citations Comparison (A=red), (B=blue), (C=green)")
plot3
```


```{r, echo = FALSE, include=FALSE}
mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE)
mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE)
mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscit, na.rm = TRUE)
median(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE)
median(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE)
median(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscit, na.rm = TRUE)
```

Using Math Sci Net, the mean number of citations for signers of Letter A is 424.64, and the median is 299. The mean number of citations for signers of Letter B is 1312.50, and the median is 866. The mean number of citations for signers of Letter C is 2204.74, and the median is 1392.5.
So it seems by directly comparing populations, signers of Letter A had less citations than their counterparts on B and C. 
Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE)
muB <- mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscit, na.rm = TRUE)
muC <- mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscit, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

dist <- meanPermutation(na.omit(df$amscit),10000)
set.seed(0)

hist(dist,
     main = "Permutation Test on MathSciNet citations",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")

```

```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```
The probability that the difference in mean number of citations between signers of A and B is 0.01%. The difference between B and C and A and C are both outside the induced distribution. So it is unlikely that the observed difference in the number of MathSciNet citations was due to chance, and we may reject all three null hypotheses. 



### MathSciNet Citations Only Professors

```{r, warning=FALSE, echo = FALSE}
plot4 <- ggplot(df, aes(x=amscit))+
  geom_histogram(data=filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor"))),fill = "red", alpha = 0.2, binwidth = 1000) + 
  geom_histogram(data=filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor"))),fill = "blue", alpha = 0.2, binwidth = 1000) +
  geom_histogram(data=filter(df,( (lettergroup == "C Only"|lettergroup == "C and B")&(role=="professor"))),fill = "green", alpha = 0.2, binwidth = 1000) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df,( (lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscit, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Math Sci Net Citations Comparison Professors (A=red), (B=blue), (C=green)")
plot4
```

```{r, echo = FALSE, include=FALSE}
mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE)
mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE)
mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscit, na.rm = TRUE)
median(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE)
median(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE)
median(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscit, na.rm = TRUE)
```
The mean number of citations on Mathscinet for professors who were signers of Letter A is 437.91, and the median is 300. The mean number of citations for professors who were signers of Letter B is 1182.27, and the median is 728.5. The mean number of citations for professors who were signers of Letter C is 2176.64, and the median is 1353.

So it seems by directly comparing populations, signers of Letter A had less citations than their counterparts on B and C. 
Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE)
muB <- mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscit, na.rm = TRUE)
muC <- mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscit, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$amscit),10000)

hist(dist,
     main = "Permutation Test on MathSciNet citations only professors",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")

```


```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```

All observed differences lie outside the induced distribution, so it is unlikely the observed differences were due to chance. Accordingly, we may reject all three null hypotheses. 


### MathSciNet Citations per Year

Older researchers have had a longer time to rack up citations, so it is important to normalize for this and divide by the length of time professionals have had their PhDs. 

```{r , warning=FALSE, echo = FALSE}
plot9 <- ggplot(df, aes(x=amscitperyear))+
  geom_histogram(data=filter(df, (lettergroup == "A Only"|lettergroup == "A and B")),fill = "red", alpha = 0.2, binwidth = 50) + 
  geom_histogram(data=filter(df, (lettergroup == "B Only"|lettergroup == "A and B")),fill = "blue", alpha = 0.2, binwidth = 50) +
  geom_histogram(data=filter(df, (lettergroup == "C Only"|lettergroup == "C and B")),fill = "green", alpha = 0.2, binwidth = 50) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citperyear, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("MathSciNet citperyear Comparison (A=red), (B=blue), (C=green)")
plot9
```

```{r, echo = FALSE, include=FALSE}
mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscitperyear, na.rm = TRUE)
mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscitperyear, na.rm = TRUE)
mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscitperyear, na.rm = TRUE)
median(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscitperyear, na.rm = TRUE)
median(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscitperyear, na.rm = TRUE)
median(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscitperyear, na.rm = TRUE)
```

The mean number of citations per year for signers of Letter A is 16.88, and the median is 13.08. The mean number of citations per year for signers of Letter B is 37.22, and the median is 24.15. The mean number of citations per year for signers of Letter C is 55.55, and the median is 42.42.

So it seems by directly comparing populations, professors on Letter A had less citations per year than their counterparts on B and C. 
Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$amscitperyear, na.rm = TRUE)
muB <- mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$amscitperyear, na.rm = TRUE)
muC <- mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$amscitperyear, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$amscitperyear),10000)

hist(dist,
     main = "Citations per Year Math Sci Net",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")
```

```{r, echo=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```

The percentage of the induced distribution that is more extreme than the observed difference in mean number of citations per year between A and B is .03%. The percentage of the induced distribution that is more extreme than the observed difference in mean number of citations per year between B and C is .18%.The observed difference in mean between A and C is outside the induced distribution. So it is unlikely that the observed difference in the number of Google Scholar citations was due to chance, and we may reject all three null hypotheses. 


### MathSciNet Citations per Year only professors

```{r , warning=FALSE, echo = FALSE}
plot5 <- ggplot(df, aes(x=amscitperyear))+
  geom_histogram(data=filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor"))),fill = "red", alpha = 0.2, binwidth = 50) + 
  geom_histogram(data=filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor"))),fill = "blue", alpha = 0.2, binwidth = 50) +
  geom_histogram(data=filter(df, ((lettergroup == "C Only"|lettergroup == "C and B")&(role=="professor"))),fill = "green", alpha = 0.2, binwidth = 50) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscitperyear, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Professor's Citations per Year Comparison (A=red), (B=blue), (C=green)")
plot5
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscitperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscitperyear, na.rm = TRUE)
```

The mean number of citations per year for professors who were signers of Letter A is 16.88, and the median is 13.08. The mean number of citations per year for professors who were signers of Letter B is 38.05, and the median is 24.15. The mean number of citations per year for professors who were signers of Letter C is 55.36, and the median is 41.74.

So it seems when comparing only professors, signers of Letter A had less citations than their counterparts on B and C. 
Let's validate this using a permutation test.


```{r}
muA <- mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE)
muB <- mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$amscitperyear, na.rm = TRUE)
muC <- mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$amscitperyear, na.rm = TRUE)

val1 <- muA-muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$amscitperyear),10000)

hist(dist,
     main = "AMS citations per year permutation test",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")
```

```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```

About 0.02% of the induced distribution is more extreme than the observed difference between A and B, so it is highly unlikely the observed difference was due to chance. Only 0.34% of the induced distribution was more extreme than the difference between B and C, and 0% between A and C, so it is unlikely those were due to chance. We may reject all three null hypotheses. 


### AMS Citations Per Year - Female Professors Only


```{r, echo=FALSE, warning=FALSE}
plot8 <- ggplot(df, aes(x=amscitperyear))+
  geom_histogram(data=filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman"))),fill = "red", alpha = 0.2, binwidth = 10) + 
  geom_histogram(data=filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman"))),fill = "blue", alpha = 0.2, binwidth = 10) +
  geom_histogram(data=filter(df, ((lettergroup == "C Only"|lettergroup == "C and B")&(role=="professor")&(gender=="woman"))),fill = "green", alpha = 0.2, binwidth = 10) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Female Professor AMS citperyear Comparison (A=red), (B=blue), (C=green)")
plot8
```

```{r, echo=FALSE, include=FALSE}
mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
```
Using the data from mathscinet, the mean number of citations per year for female professors who were signers of Letter A is 15.30, and the median is 5.55. The mean number of citations per year for female professors who were signers of Letter B is 22.54, and the median is 14.80. The mean number of citations per year for female professors who were signers of Letter C is 35.04, and the median is 22.70.

So it seems when comparing only female professors, signers of Letter A had less citations than their counterparts on B and C. 

Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
muB <- mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)
muC <- mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$amscitperyear, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)


dist <- meanPermutation(na.omit(filter(df, ((gender=="woman")&(role=="professor")))$amscitperyear),10000)

hist(dist,
     main = "MathSciNet citperyear Female Professors",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")
```
```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```
20.37% of the induced distribution was more extreme than the observed difference in mean between A and B. 7.38% of the induced distribution was more extreme than the observed difference in mean between B and C. 0.88% of the induced distribution was more extreme than the observed difference in ean between A and C. We fail to reject the difference in mean between female professors of Letter A and B, but we may reject the null hypothesis for the difference in citations per year for female signers of B and C, and C and A. 


## hindex

An h-index is an alternative metric to citations to assess author impact. It attempts to balance the number of published papers and the number of citations. 

```{r, echo=FALSE, warning=FALSE}
plot8 <- ggplot(df, aes(x=hindex))+
  geom_histogram(data=filter(df, (lettergroup == "A Only"|lettergroup == "A and B")),fill = "red", alpha = 0.2, binwidth = 10) + 
  geom_histogram(data=filter(df, (lettergroup == "B Only"|lettergroup == "A and B")),fill = "blue", alpha = 0.2, binwidth = 10) +
  geom_histogram(data=filter(df, (lettergroup == "C Only"|lettergroup == "C and B")),fill = "green", alpha = 0.2, binwidth = 10) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$hindex, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("hindex Comparison (A=red), (B=blue), (C=green)")
plot8
```

```{r, echo=FALSE, include=FALSE}
mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE)
mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE)
mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$hindex, na.rm = TRUE)
median(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE)
median(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE)
median(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$hindex, na.rm = TRUE)
```


The mean number of h-index for signers of Letter A is 9.73, and the median is 6. The mean number of h-index for signers of Letter B is 20.78, and the median is 17. The mean h-index for signers of Letter C is 32.24, and the median is 29.5.

It appears that the signers of letter A had a lower h-index than signers of B and C. Let's assess this using a permutation test. 

```{r}
muA <- mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE)
muB <- mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$hindex, na.rm = TRUE)
muC <- mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$hindex, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

dist <- meanPermutation(na.omit(df$hindex,cols="hindex"),10000)

hist(dist,
     main = "hindex",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")

```

All three differences in mean number of citations lie outside of the induced distribution, so it is unlikely that the observed differences were due to chance. We may hence reject the null hypothesis. 

## Control: Rutgers Math Department

As a control, we look at the Google Scholar citations, the AMS citations, respective citations per year, and h indices of the Rutger's math department. 

```{r, echo = FALSE, include=FALSE, warning=FALSE}
df2 <- read_csv("~/Desktop/Notices/rutgers.csv")
```
```{r, echo=FALSE}
df2$age <- (2020- df2$phd)
df2$citperyear <- df2$GoogleScholar/df2$age
df2$amscitperyear <- df2$AMSCIT/df2$age
summary(df2)
```

```{r, include = FALSE, echo = FALSE}
mean(na.omit(df2$age))
mean(na.omit(df2$hindex))
mean(na.omit(df2$AMSCIT))
mean(na.omit(df2$GoogleScholar))
mean(na.omit(df2$citperyear))
mean(na.omit(df2$amscitperyear))
```
The mean age for Rutger's faculty was 35.72 years. The mean h-index was 27.3. The mean Google Scholar citations was 3392.8. The mean AMS citations is 1297.19. The mean Google Scholar citations per year is 101.75. The mean AMS citations is 35.01. 

This is in line with signers of letter B, greater than signers of letter A, and slightly less than that of signers of letter C. 

## Asian and Eastern European Born
We are interested in the proportion of letter signers who are Math Professors at R1 universities, who were born in Eastern European or Asian Countries. We created this data by looking at Wikipedia's and personal knowledge.

```{r, echo=FALSE,include=FALSE}
df3<- read_csv("./From.csv")
df3$From <- as.factor(df3$From)
df3$Letter <- as.factor(df3$Letter)
```
Summary Statistics. 
```{r,echo=FALSE}
summary(df3$From)
```

```{r}
table(filter(df3, (Letter == "A Only"|Letter == "A and B"))$From)
```
No signers of Letter A who were Math Professors at R1 universities, were from Eastern European or Asian Countries. 

```{r}
table(filter(df3, (Letter == "B Only"|Letter == "A and B"))$From)
```
Looking at signers of Letter B who were Math Professors at R1 universities, we find there were 6 native Chinese, 1 native Croatian, 1 native Iranian, 1 native Japanese, 1 native Dutch, 3 native Polacks, 3 native Romanians, 31 native Russians, 2 native Serbians, and 1 native Turk. 

```{r}
table(filter(df3, (Letter == "C Only"|Letter == "B and C"))$From)
```
Looking at signers of Letter C who were Math Professors at R1 universities, we find there were 12 native Chinese, 1 native Czech, 1 native Greek, 4 native Hungarians, 1 native Korean, 4 native Romanians, 36 native Russians, and 1 native Turk. 

# Conclusion and Discussion
We see the following patterns amongst the ``established'' mathematicians who signed the three letters: the citations numbers distribution of the signers of Letter A is similar to that of a mid-level mathematics department (such as, say, Temple University), the citations metrics of Letter B are closer to that of a top 20 department such as Rutgers University, while the citations metrics of the signers of Letter C are another tier higher, and are more akin to the distribution of metrics for a truly top department. These differences persist if we restrict our study to female mathematicians only.

What explains these results? The difference in tone between the three letters can be summarized as follows: Letter A is the least meritocratic, suggesting the value of using political factors in preference to mathematical merit. Letter B takes no position on the meritocracy (though it is clear that it is opposed to the greater politicization of academic life), and Letter C is pro-meritocracy and diversity. It is then not surprising that people with the most "merit" in the judgement of the community support the most meritocratic letters, so the cynical analysis is simply that people are, as they say in finance, ``talking their book'' - advocating policies which are most advantageous to them and people like them. However, it is not quite so simple.

Notice that the mathematicians from Communist countries (Eastern Europe and China) are considerably overrepresented amongst the signers of Letters B and C, and are not represented at all amongst the signers of Letter A. The reason for this is that it was very common for talented people in those country to go into Mathematics because it was the least political of the sciences (no expensive equipment or large teams of research are generally needed). All of those countries had severe discrimination against some ethnic and social groups in favor of supposedly disadvantaged groups - many of the signers were so talented that they could overcome the discrimination, but they generally had many friends who were only a little less spectacular who had to settle for working outside mathematics (or doing mathematics as a hobby). As a result, the very thought of bringing more exogenous (as opposed to the usual ``academic'', and unavoidable) politics into the field fills them with revulsion.

It is thus not correct, as done by Topaz et al,[8] to view letters B and C as the voice of the ``power elite'' - the people described above had generally arrived to the US with nothing but the shirts on their backs and got ahead through sheer talent and hard work.



# Bibliography

[1] https://www.ams.org/journals/notices/201911/rnoti-p1778.pdf

[2] https://www.ams.org/journals/notices/202001/rnoti-o1.pdf

[3] https://qsideinstitute.org/2019/11/19/diversity-statements-in-hiring-the-american-mathematical-society-and-uc-davis/

[4] https://pypi.org/project/scholarly/

[5] https://scholar.google.com/

[6] https://genealogy.math.ndsu.nodak.edu/

[7] https://github.com/j2kun/math-genealogy-scraper

[8] https://qsideinstitute.org/download/ams-letters-study/

[9] http://www.ams.org/profession/data/annual-survey/2016dp-tableDF1.pdf?fbclid=IwAR1mgI0qSEs5nCGquqye741_0lZU-ez7dlcJ3wZYhDtJUswhH1SX7yeiiak

# Appendix

## Data and Code
All Data and Code is available at https://github.com/joshp112358/Notices 

## Google Scholar Citations

```{r, echo=FALSE, warning=FALSE}
plot2 <- ggplot(df, aes(x=citations))+
  geom_histogram(data=filter(df, (lettergroup == "A Only"|lettergroup == "A and B")),fill = "red", alpha = 0.2, binwidth = 5000) + 
  geom_histogram(data=filter(df, (lettergroup == "B Only"|lettergroup == "A and B")),fill = "blue", alpha = 0.2, binwidth = 5000) +
  geom_histogram(data=filter(df, (lettergroup == "C Only"|lettergroup == "C and B")),fill = "green", alpha = 0.2, binwidth = 5000) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citations, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citations, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citations, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Google Scholar Citations Comparison (A=red), (B=blue), (C=green)")
plot2
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citations, na.rm = TRUE)
mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citations, na.rm = TRUE)
mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citations, na.rm = TRUE)
median(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citations, na.rm = TRUE)
median(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citations, na.rm = TRUE)
median(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citations, na.rm = TRUE)
```

The mean number of citations for signers of Letter A is 947.73, and the median is 161. The mean number of citations for signers of Letter B is 3144.062, and the median is 1246. The mean number of citations for signers of Letter C is 6074, and the median is 3307.

So it seems by directly comparing populations, signers of Letter A had less citations than their counterparts on B and C, and that signers of B had less citations than those on C. 

Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citations, na.rm = TRUE)
muB <- mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citations, na.rm = TRUE)
muC <- mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citations, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$citations),10000)

hist(dist,
     main = "Permutation Test on GS citations",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")

```

All three differences in mean number of citations lie outside of the induced distribution, so it is unlikely that the observed differences were due to chance. So we can reject all three null hypotheses, and deduce that the signers of letter A had less citations than signers of B and C. 

## Google Scholar Citations Only Professors

It is difficult to compare grad students or recently graduates to professors. So we should subset the data, and reperform the analysis comparing only professors. 

```{r, echo=FALSE, warning=FALSE}
plot4 <- ggplot(df, aes(x=citations))+
  geom_histogram(data=filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor"))),fill = "red", alpha = 0.2, binwidth = 5000) + 
  geom_histogram(data=filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor"))),fill = "blue", alpha = 0.2, binwidth = 5000) +
  geom_histogram(data=filter(df,( (lettergroup == "C Only"|lettergroup == "C and B")&(role=="professor"))),fill = "green", alpha = 0.2, binwidth = 5000) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df,( (lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citations, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("GS Citations Comparison Professors (A=red), (B=blue), (C=green)")
plot4
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE)
mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE)
mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citations, na.rm = TRUE)
median(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE)
median(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE)
median(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citations, na.rm = TRUE)
```
The mean number of citations for professors who were signers of Letter A is 2397.75, and the median is 954. The mean number of citations for professors who were signers of Letter B is 4136.432, and the median is 1923. The mean number of citations for professors who were signers of Letter C is 6226.816, and the median is 3307.

So it seems by directly comparing populations, professors on Letter A had less citations than their counterparts on B and C. 
Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE)
muB <- mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citations, na.rm = TRUE)
muC <- mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citations, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$citations),10000)

hist(dist,
     main = "Permutation Test on GS citations only professors",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")

```
```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```
The probability that the difference in mean number of citations between signers, comparing only professors, of A and B is 0.03%. The difference between B and C and A and C are both outside the induced distribution. So it is unlikely that the observed difference in the number of Google Scholar citations was due to chance, and we may reject all three null hypotheses. 

## Google Scholar Citations per Year

```{r , warning=FALSE, echo = FALSE}
plot5 <- ggplot(df, aes(x=citperyear))+
  geom_histogram(data=filter(df, (lettergroup == "A Only"|lettergroup == "A and B")),fill = "red", alpha = 0.2, binwidth = 50) + 
  geom_histogram(data=filter(df, (lettergroup == "B Only"|lettergroup == "A and B")),fill = "blue", alpha = 0.2, binwidth = 50) +
  geom_histogram(data=filter(df, (lettergroup == "C Only"|lettergroup == "C and B")),fill = "green", alpha = 0.2, binwidth = 50) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citperyear, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Citations per Year Comparison (A=red), (B=blue), (C=green)")
plot5
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE)
mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE)
mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citperyear, na.rm = TRUE)
median(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE)
median(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE)
median(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citperyear, na.rm = TRUE)
```

The mean number of citations per year for signers of Letter A is 69.25, and the median is 22.90. The mean number of citations per year for signers of Letter B is 117.62, and the median is 48.73. The mean number of citations per year for signers of Letter C is 176.99, and the median is 116.67.

So it seems by directly comparing populations, professors on Letter A had less citations per year than their counterparts on B and C. 
Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, (lettergroup == "A Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE)
muB <- mean(filter(df, (lettergroup == "B Only"|lettergroup == "A and B"))$citperyear, na.rm = TRUE)
muC <- mean(filter(df, (lettergroup == "C Only"|lettergroup == "B and C"))$citperyear, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$citperyear),10000)

hist(dist,
     main = "Citations per Year Google Scholar",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")
```

```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```
The percentage of the induced distribution that is more extreme than the observed difference in mean number of citations per year between A and B is 4%. The percentage of the induced distribution that is more extreme than the observed difference in mean number of citations per year between B and C is 1.22%.The observed difference in mean between A and C is outside the induced distribution. So it is unlikely that the observed difference in the number of Google Scholar citations was due to chance, and we may reject all three null hypotheses. 



## Google Scholar Citations per Year only professors

```{r , warning=FALSE, echo = FALSE}
plot5 <- ggplot(df, aes(x=citperyear))+
  geom_histogram(data=filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor"))),fill = "red", alpha = 0.2, binwidth = 50) + 
  geom_histogram(data=filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor"))),fill = "blue", alpha = 0.2, binwidth = 50) +
  geom_histogram(data=filter(df, ((lettergroup == "C Only"|lettergroup == "C and B")&(role=="professor"))),fill = "green", alpha = 0.2, binwidth = 50) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citperyear, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Professor's Citations per Year Comparison (A=red), (B=blue), (C=green)")
plot5
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citperyear, na.rm = TRUE)
```

The mean number of citations per year for professors who were signers of Letter A is 139.26, and the median is 47.56. The mean number of citations per year for professors who were signers of Letter B is 136.14, and the median is 62.81. The mean number of citations per year for professors who were signers of Letter C is 182.78, and the median is 111.73.

So it seems by directly comparing populations, signers of Letter A had more citations than their counterparts on B, though less than their counterparts C. 

Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE)
muB <- mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")))$citperyear, na.rm = TRUE)
muC <- mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")))$citperyear, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)
dist <- meanPermutation(na.omit(df$citperyear),10000)

hist(dist,
     main = "GS citations per year Professors Only",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")
```

```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```

About 54.72% of the induced distribution is more extreme (less) than the observed difference between A and B, so it is highly likely the observed difference was due to chance. We fail to reject the null hypothesis that mean of A is equal to B. Only 4.61% of the induced distribution was more extreme than the difference between B and C, and 6.06% between A and C, so it is unlikely those were due to chance. We can thus reject the null hypothesis that $\mu(B)=\mu(C)$ and $\mu(C)=\mu(A)$, but with less certainty than the observed difference for age. 


## Google Scholar Citations Per Year - Female Professors Only


```{r, echo=FALSE, warning=FALSE}
plot7 <- ggplot(df, aes(x=citperyear))+
  geom_histogram(data=filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman"))),fill = "red", alpha = 0.2, binwidth = 50) + 
  geom_histogram(data=filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman"))),fill = "blue", alpha = 0.2, binwidth = 50) +
  geom_histogram(data=filter(df, ((lettergroup == "C Only"|lettergroup == "C and B")&(role=="professor")&(gender=="woman"))),fill = "green", alpha = 0.2, binwidth = 50) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE), linetype="dotted", color = "red", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE), linetype="dotted", color = "blue", size=1.5) +
  geom_vline(xintercept = mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE), linetype="dotted", color = "green", size=1.5) +
  ggtitle("Female Professor GS Citations per Year Comparison (A=red), (B=blue), (C=green)")
plot7
```

```{r, echo = FALSE, include = FALSE}
mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
median(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
```

The mean number of citations per year for female professors who were signers of Letter A is 58.25, and the median is 24.28. The mean number of citations per year for female professors who were signers of Letter B is 82.40, and the median is 31.94. The mean number of citations per year for female professors who were signers of Letter C is 72.29, and the median is 64.56.

So it seems when comparing only female professors, signers of Letter A had less citations per year than their counterparts on B and C, while signers of B had more citations per year than C. 

Let's validate this using a permutation test.

```{r}
muA <- mean(filter(df, ((lettergroup == "A Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
muB <- mean(filter(df, ((lettergroup == "B Only"|lettergroup == "A and B")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)
muC <- mean(filter(df, ((lettergroup == "C Only"|lettergroup == "B and C")&(role=="professor")&(gender=="woman")))$citperyear, na.rm = TRUE)

val1 <- muA - muB
val2 <- muB - muC
val3 <- muA - muC

set.seed(0)


dist <- meanPermutation(na.omit(filter(df, ((gender=="woman")&(role=="professor")))$citperyear),10000)

hist(dist,
     main = "GS citperyear Female Professors",
     xlab = "Differences in Mean")
abline(v=val1, col = "red")
abline(v=val2, col = "blue")
abline(v=val3, col = "green")
```

```{r, echo=FALSE, include=FALSE}
sum(dist < val1)/length(dist)
sum(dist < val2)/length(dist)
sum(dist < val3)/length(dist)
```

18% of the induced distribution was more extreme than the observed difference in mean between A and B. 63.52% of the induced distribution was more extreme than the observed difference in mean between B and C. 31.56% of the induced distribution was more extreme than the observed difference in ean between A and C. So all of these had a high likelihood of being produced by chance, and we fail to reject all three null hypotheses. 

